local map = MapDef(
    340,
    "0706131721",
    "2D7A3523303E3075715B33364A3D604C4954457B205839672532355A502E604B6B473D654A2E433660553D36314C5D32406940746B74512038762532625C2A283B54756C2E2777284C3B3C406951406E743731233E4565342D7E48414F745A302922217944526C4448765278414A63315F7A2532357457316666707A716952465636274C785563687B332023542A76354B5672493D4649343E2A3526794D41732532626656362A314B662F4A39354D6C36636F4257423D6D4977266124",
    "28230a2658042b4f2257283d5c57542d3c532108081c0a15344159174f1d62665a1b100d4f461649045354720c30210f1556794b5f0a00554c1f2920071c3b514c4340182533242c29173719202b02501712441532500707111b390133273357462d19342b001a524542354b1754033e1328582728555f4b7d4e182c24124a07375762592a074a2b58542c0d7e0b0e2332235c0c28166e09454c1f5442515f513d193a52532b5c012d281c0b3c6f3d5b56443b3166080559224c022b4f227e08127253502d3c53212128150a11304159174a1442495a31140d4f461660245a5d250830210f157f59425f2004554c1f290927153b5548434018251a042529133319202b0279371b4411365007071132190833233757462d191d0b091a564142354b177d2337132c5c2728555f625d47182820124a07377e647604034e2b58542c245e2d5d2736235c0c283f4e266b481b5442515f781d103a56572b5c012d013c241a45395806443b1846012a0e265c042b4f0b5e01345857502d3944080121150e153041591763344b495e35140d4f463f402d5a59210830210f3c5f50425b2404554c1f00292e153f51484340180c3a0d252d173319202b2b593e1b4015365002133834362637273757462d303d2d5a1e524142354b3e5d0c1917285c272855764254471c2c20124a071e5e4b502e074e2b5854050457310a2336235c0c011f4700414c1b544251765814103e52572b5c01042135241e413958064412384f012e0a265c042b662b5701305c57502d3c7a280821110a153041593e433d4b4d5a35140d4f6f1f492d5e5d21083021263a707e465f2404554c36200f7d113b51484340312c1523212917331920020b503e1f44153650072e181b100c3327375746041034020d1a52414235621e542a3313285c27287c564b5443182c20124a2e3e574b542a074e2b587d250d57060e2336235c2521164704454c1b544278565114143a52572e4b28242835201a413958066d32314f052a0a265c040260047905345c57502d155a0e5b25150a153041701e6c134f495a35140d664f1649295a5d2108300806155654425f240455651629202a153b5148436911253309267a173319097924613a1b441536502e0e111b1408332737576f24193406091a5241421c4217542e3713285c27015c5f4b5047182c2012630e37574f502a074e2b715d2c0d53020e233623752328384300454c1b546b58700210103a52572b75080b0631241a4139582f4d3b314b02790a265c2d224f225301345c5750043553210c21150a15306850174a394b495a3514246060384d2d5a5d21081973293b5250425f24047c451f29242e153b51486a491825370d2529173330292b02543e1b441536790e07111f10083327377e4f2d193002091a52416b3c4b17502a3713285c0e217a0c4f4441182c203b4321195348002a074e0251542c0957020e23360a550c28124700454c1b7d4b515f5514103a52570255012d2c35241a441971296215354c512f5a13750d041c265701310c63797f3c7d250821150f35194859174e3d4b495f213d044f4612492d5a5d212139210f115650425f242d5c4c1f2d202e153b51614a401821330d2529171a10297806503e1b44151f592129151b100833271e5e462d1d3402091f72684b354b13542a371328752e28555b4b5447182c091b4a0733574b502a0767047e7a280e07020e231f2a73592c164700454c325d6d025b5114156a677e797a2f292835241a41105106443f314f012a0a0f55042b4b225701345c7e592d3c57210821101d3c394159134a3d4b495a1c1d0d4f4216492d5a5d0801160f0b155650425f0d0d554c1b29202e153b784143401c29080d25293e3a19202f02503e1b443c3f500703111b1008330e18716829193402091a7b486d664f17542a3713010e087e515f4b54471805723d1c0337574b502a2e1c0d76502c0d57020e0a3f235c08281647004565125442555f5114103a7b5e2b5c052d2835241a68305806403b314f012a232f5c2a2f4f22570134755e502d385321082115231c30415d174a3d4b49733c140d4b4616492d5a74280830250f15565042760b2264481f29202e1512586710441825330d25001e1c27242b02503e1b6d3a19080307111b10081a3e1869422d193402093300676c314b17517a023a215c272c555f4b5447312520124e0737574b50030e4e2b5c542c0d5702272a3623580c281647006c451b5446515f511410135b572b58012d2835243348395802443b314f010303265c002b4f2257011d555750293c53210d353c1333004559174a3d4b60531a2a094f4616492d730f075f34210f1556506b0d0253514c1f29202e3c227e7647401825330d0c7b171d1d202b02552a324d1536540707111b10213a273753462d1931162013524146354b17542a1e1a285c2328555f4b546e112c20164a0737574b7923074e2f58542c0d572b072336275c0c281647294c4c1b5042515f5114391574792f5c012d28350d136e075c06443b314f28052c7258042b4f2257281b7a01542d3c532108081c2c42344159174a3d62407563100d4f46164904087b0f0c30210f1556794b5f2400554c1f2920071c3b514c4340182533242c29173719202b02501712441532500707111b390133273357462d19342b001a524542354b1754033e1328582728555f4b7d683e0224124a073757625905394a2b58542c0d7e2d287732235c0c28166e0963481f5c65515f513d421c04532b5c0128241c7635193d5806443b316608055f225c042b4f227e08126d53502d3c53212128150a11304159174a1442495a31140d4f461660245a5d250830210f157f59425f2004554c1f290927153b5548434018251a04252913304a202b0279111b6a1136500702053219270d233757462d191d2d2f4e564142354b177d2311172c5c27284549625d611c0620124f57007e19767e034e2b58542c244e2d302736235c0c283f152675481b5442515f781d103a56572b5c012d013c241a45395806443b1846012a0e265c042b4f0b5e01345857502d3c53080121150e153041591763344b495e35140d4f463f660b7459210835713b3c797f145b2404554c1f000f08423f51484340180c3a2b212d173319202b2b59181f5015365007073812360c3b273757563b3066245d1e524142354b3e4d050917285c273843761972691c2c20124a071e5e4b502e074e2b5854050457020a233623591b011f4700414c1b544251765814103e52572b5c01042135241e4139580644121e69302e0a265c042b662b7852305c57502d3c7a73271f110a1530514f3e531b1f4d5664140d4f6f1f6f295e5d210d6016261c70544e5f2404455a3620062a113b51484658312c155a212917331920020b7f681f44153650072e433d3e0c3327375746041034020d1a52414721621e542a3313285c27287c564b5443182c20124a2e3e574b542a074e2b587d250d57060e2336235c2531306904454c1b544278567e47143a52572b5c287f070b201a413958066d22171b052a0a265c040246045305345c57502d155a070c251d2d11304170456c6b4f495a35041b66143911295a5d21083008063a0554425f240455654d0f0e2a153b51484369112533092529173639092202503a1b441536502e0e111b1408332732406f24193406091a5241421c4217542e3713285c27014c79655047182c2012630e18024f502a074e2b714d035553020e23362375150e404308624c0b426b587955101c6b57071c75080b2c31241a4139582f4d1d664b012a0a265c2d2260745301345c575004357c720c21150a1530680b3164394b495a3514244646164d2d5a5d210819280f155250425f24047c451f29242e153b51486a491825370d2529121330292b02543e1b441536791e21211f10083327377e69024f3002091a52416b1a6d40502a3713285c0e21735b4f5447182c203b432133534b502a074e025172780957020e23360a732316124700454c1b7d4b7e0c5514103a525702552e7e2c35241a413971546215354f012a0a26750d2b4f265701345c5779243c53250821150a15194859174e3d4b495a353d044f4612492d5a5d21211f073e115650425f242d5c634c2d202e153b5161116f2621330d2529171a00067f06503e1f44151f592103151b100833271e5e60791d3402091a52686d1a7513587b371328752e07065b4b5447182c091b6c3733574b502a0767227707280d57020e231f715c222c164700454c325d42515b5114103a527e225c01292835241a41105106443f314f012a0a0f55042b4b225701345c7e490b1257210824453f3c396e0a134a3d4b495a1c4622714216492d5a5d081116750b155650425f0d0d73181b29202e153b78676c7e1c25330d25293e3a36732f02503e1b443c3f762903111b1008330e2e716829193402091a7b486d664f07522a371301552728515f4b5447180529124a0337574b502a2e472b58502c0d5707190a3f235c08281647004565125442555f5114103a7b4e0d72052d2835241a68307755403b314f012a2374733a2f4f22530134754e767a385321082115233a1f7f5d1b1a3d4b49733c3b5e4b4616492d5a74282e1e250f15530076762d0455481f29202e1512486e6d441825330d25001e3a4a242b02503e1b6d1c36500307111b10081a2e3757422d19340209335b4142314b17542a373a215c272c555f4b5447312520124e0737574b50031e68055c542c0d5702272a1970580c281647006c1e346a46515f511410137d781558012d2835243348160b02443b314f0103030072002b4f2257011d555750293c532108213c0315304559174a3d4b6043133a094f4616492d7354210834210f1556506b562404514c1f29202e3c32514847401825330d0c2017331d202b02503e324d1536540707111b10213a273753462d1934022003746f46354b17542a1e1a070f2328555f4b546e010376164a0737574b7923281d2f58542c0d572b5c0506275c0c281647294c4c1b5042515f5114393352572f5c012d28350d1341395c06443b314f28330a0858042b4f2257283d5c57542d3c532108081c0a15344159174a3d62405a35100d4f46164904535d210c30210f1556794b5f2400554c1f2920071c3b514c4340182533243c0f393719202b02501712622532500707111b39011c743357462d19342b0035014542354b1754033e3519582728555f4b7d4e182c24124a07375762592a074a2b58542c0d7e0b0e2332235c0c28166e09454c1f5442515f513d193a52532b5c012d281c2d1a413d5806443e2666082a0a225c042b4f227e08345c53502d3c53212128150a11304159126a1442495a31140d4f430260347c6c250830210f157f49646f2004554c1f2909273a685548434018251a040307133319202b0279371b4411365007071132190833233757462d191d0b091a564142354b177d2337132c5c2728555f625d47182820124a07377e42502a034e2b58542c245e020e2736235c0c283f4e0045481b5442515f781d103a56572b5c012d013c241a45395806443b1846012a0e250f042b4f0b78271a5857502d3c5308010e460e153041591763346d675e3644081f733f402d5a59210830210f3c5f50425b2404554c1f00292e153f51484340180c3a0d252d173319202b2b593e1b4015365007073812100837273757433a303d02091e524142354b3e5d2a3717285c272855764254471c2c20124f201e5e4b502e074e2b5854050457020a2336235c0c0139612e414c1b54425176583b433e52572b5c010421130a1e413958064412384f012e0a265c042b662b5701305c57502d3c7a280821110a153041593e433d4b4d5a35140d4f6f1f492d5e5d21083021261c5650465f2404554c3620202e113b51484340312c330d212917331c04020b503e1f44153650072e181b100c3327375746041034020d1a52414235623872043310785c27287c56640743182c20124a2e3e71655429574e2b587d250d57060d7036235c2521164704454c1b544278565114143a52572b5c28242835201a413958066d32314f052a0a265c040246225705345c57502d155a210825150a153041701e4a3d4f495a35140d664f1649295a5d2108300806155654425f240455651629202a153b5148436937031d09252917331909222d033a1b441536502e0e37351408332737576f241934060a495241421c4217542e3713285c27015c5f4b5047182c2012630e37574f502a074b0f715d2c0d53020e233623750528164300454c1b546b585f5110103a52572b75082d2831241a4139582f4d3b314b012a0a265c2d224f225301345c5750043553210c21150a101068763164394b495a3514244669454d3d5c5d21081928293b5250425f24047c451f29242e153b51486a49182537011e29173330292b02543e1b441021790e07111f10083327377e4f2d193002091a52416b3c4b17502a3713285c0e21555f4f5447182c203b430737534b502a074e0251542c0957020e23360a550c28124700454c1b7d4b515f5514103a5257027301032c35241a4139710f4d68354f012a0a26750d2b61265701345c5779243c53250821150a15194859174e3d4b495a353d044f4612492d5a5d212139210f115650425f242d5c4c1f2d202e153b51614a401821330d2529171a10202b06503e1b4415",
    15,
    17,
    -2,
    17,
    9
)

map.positions = "cycMcNc0c1c2dddedrdU|dYepeQeReSe5e6fhfifj"
map.capabilities = 12

map.allowedMobGrades = {
    {150, 1},
    {150, 2},
    {150, 3},
    {150, 4},
    {150, 5},
    {249, 1},
    {249, 2},
    {249, 3},
    {249, 4},
    {249, 5},
    {876, 1},
    {876, 2},
    {876, 3},
    {876, 4},
    {876, 5},
    {53, 1},
    {53, 2},
    {53, 3},
    {53, 4},
    {53, 5},
    {74, 1},
    {74, 2},
    {74, 3},
    {74, 4},
    {74, 5},
    {110, 1},
    {110, 2},
    {110, 3},
    {110, 4},
    {110, 5},
    {291, 1},
    {291, 2},
    {291, 3},
    {291, 4},
    {291, 5},
    {54, 1},
    {54, 2},
    {54, 3},
    {54, 4},
    {54, 5},
    {259, 1},
    {259, 2},
    {259, 3},
    {259, 4},
    {259, 5},
    {207, 1},
    {207, 2},
    {207, 3},
    {207, 4},
    {207, 5}
}

local function tryEntering(_, _, p)
    if p:getItem(818) then
        if p:consumeItem(818, 1) then
            p:teleport(1506, 109)
        else
            -- TODO: send error (in chat)
        end
    end
end

map.onMovementEnd = {
    [318] = moveEndTeleport(341,349),
	[456] = moveEndTeleport(350,34),
	[102] = moveEndTeleport(339,187),
	[18] = moveEndTeleport(330,440),
	[227] = tryEntering
}

RegisterMapDef(map)
